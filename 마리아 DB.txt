use mysql; # 데이터베이스 이름

drop table if exists member, reservation, administer, ticket, food, foodmenu, attraction, timetable; # 테이블 초기화

create table if not exists administer # 관리자
(
    aId       varchar(10) primary key,                         # 관리자 아이디
    aPass     varchar(10) not null,                            # 관리자 비밀번호
    aName     varchar(10) not null,                            # 관리자 이름
    aGender   tinyint(1)  not null check ( aGender in (0, 1)), # 관리자 성별
    aBirth    date        not null,                            # 관리자 생일
    aPosition varchar(10) not null                             # 관리자 직책
);
create table if not exists ticket # 이용권
(
    tPass  varchar(4) primary key, # 이용권 번호
    tName  varchar(10) not null,   # 이용권 이름
    tPrice int         not null    # 이용권 가격
);

create table if not exists food # 음식점
(
    fId   varchar(10) primary key,     # 음식점 번호
    fName varchar(10) not null unique, # 음식점 이름
    fUrl  varchar(50) not null         # 음식점 사진 url
);

create table if not exists foodMenu # 음식점 메뉴
(
    fId     varchar(10) not null,    # 음식점 번호
    fmName  varchar(10) primary key, # 메뉴 이름
    fmPrice int         not null,    # 메뉴 가격
    foreign key (fId) references food (fId) on delete cascade
);

create table if not exists attraction # 놀이기구
(
    atId    varchar(10) primary key,                       # 놀이기구 번호
    atName  varchar(10) not null unique,                   # 놀이기구 이름
    atUrl   varchar(50) not null,                          # 놀이기구 사진 url
    atMax   int         not null,                          # 놀이기구 수용 최대 인원
    atOnoff tinyint(1)  not null check (atOnoff in (0, 1)) # 놀이기구 운휴
);

create table if not exists timeTable # 일정표
(
    tiId      varchar(10) primary key,  # 일정표 아이디
    tiDay     int         not null, # 요일
    tiTime    time        not null, # 시간
    tiContent varchar(50) not null  # 내용
);

create table if not exists member # 회원
(
    mId     varchar(10) primary key,                          # 회원 아이디
    mPass   varchar(10) not null,                             # 회원 비밀번호
    mName   varchar(10) not null,                             # 회원 이름
    mGender tinyint(1)  not null check ( mGender in (0, 1) ), # 회원 성별
    mBrith  date        not null,                             # 회원 생일
    tPass   varchar(4),                                       # 회원의 이용권 번호
    foreign key (tPass) references ticket (tPass) on delete cascade
);

create table if not exists reservation # 예약
(
    no    int primary key,      # 예약번호
    mId   varchar(10) not null, # 회원 아이디
    tPass varchar(4)  not null, # 이용권 번호
    atId  varchar(10) not null, # 놀이기구 번호
    rTime datetime    not null, # 예약시간
    foreign key (mId) references member (mId) on delete cascade,
    foreign key (tPass) references member (tPass) on delete cascade,
    foreign key (atId) references attraction (atId) on delete cascade
);